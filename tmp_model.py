# -- coding: utf-8 --
# @Time: 2022-04-11 15:19
# @Author: WangCx
# @File: tmp_model
# @Project: HypergraphNN_test
import torch
import torch.nn as nn
from torch.nn.init import xavier_normal_, xavier_uniform_
from tqdm import tqdm
import random
import torch.nn.functional as F


class BaseClass(torch.nn.Module):
    def __init__(self):
        super(BaseClass, self).__init__()
        self.cur_itr = torch.nn.Parameter(torch.tensor(0, dtype=torch.int32), requires_grad=False)
        self.best_mrr = torch.nn.Parameter(torch.tensor(0, dtype=torch.float64), requires_grad=False)
        self.best_itr = torch.nn.Parameter(torch.tensor(0, dtype=torch.int32), requires_grad=False)


class HyperNet(BaseClass):
    def __init__(self, dataset, emb_dim, hidden_drop):
        super(HyperNet, self).__init__()
        self.emb_dim = emb_dim
        self.dataset = dataset
        self.E = torch.nn.Embedding(dataset.num_ent, emb_dim, padding_idx=0)
        self.R = torch.nn.Embedding(dataset.num_rel, emb_dim, padding_idx=0)
        self.W0 = torch.nn.Parameter(torch.empty(size=(2*emb_dim, emb_dim)))
        self.W1 = torch.nn.Parameter(torch.empty(size=(2*emb_dim, emb_dim)))
        self.W = torch.nn.Parameter(torch.empty(size=(emb_dim, 300)))
        self.a = torch.nn.Parameter(torch.empty(size=(2*emb_dim, 1)))
        self.linear = torch.nn.Linear(2*self.emb_dim, self.emb_dim)
        xavier_normal_(self.E.weight.data)
        xavier_normal_(self.R.weight.data)
        xavier_normal_(self.W0.data)
        xavier_normal_(self.a.data)
        xavier_normal_(self.W1.data)
        xavier_normal_(self.W.data)
        self.hidden_drop_rate = hidden_drop
        self.hidden_drop = torch.nn.Dropout(self.hidden_drop_rate)
        self.leakyrelu = torch.nn.LeakyReLU(0.2)


    def er_pos_emb(self, r_emb, e_emb):
        return torch.mm(torch.cat((r_emb, e_emb), dim=1), self.W1)


    def forward(self, batch):
        r_idx = batch[:, 0]
        r = self.R(r_idx)

        if batch.shape[1] == 3:
            e1 = self.E(batch[:, 1])
            e2 = self.shift(self.E(batch[:, 2]), int(1*self.emb_dim/5))

            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            # re1_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)))
            # re2_att = torch.exp(self.leakyrelu(re2)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)))
            # r = re1 * re1_att + re2 * re2_att


            e1_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re2), dim=1), self.a))))
            e1_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re2), dim=1), self.a))))
            e2_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re2), dim=1), self.a))))
            e2_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re2), dim=1), self.a))))

            # e1 = self.linear(torch.cat((e1, torch.tanh(e2*e1_e2_att)), dim=1))
            # e2 = self.linear(torch.cat((e2, torch.tanh(e1*e2_e1_att)), dim=1))

            # new_e1 = torch.mm(torch.cat((e1, (z2*e1_e2_att)), dim=1), self.W0)
            # new_e2 = torch.mm(torch.cat((e2, (z1*e2_e1_att)), dim=1), self.W0)
            new_e1 = (re1*e1_e1_att + re2*e1_e2_att)
            new_e2 = (re1*e2_e1_att + re2*e2_e2_att)
            e = r * new_e1 * new_e2

        elif batch.shape[1] == 4:
            e1 = self.E(batch[:, 1])
            e2 = self.E(batch[:, 2])
            e3 = self.E(batch[:, 3])
            # re1 = torch.matmul(self.er_pos_emb(r, e1), self.W)
            # re2 = torch.matmul(self.er_pos_emb(r, e2), self.W)
            # re3 = torch.matmul(self.er_pos_emb(r, e3), self.W)
            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re1_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)))
            re2_att = torch.exp(self.leakyrelu(re2)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)))
            re3_att = torch.exp(self.leakyrelu(re3)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)))
            r = re1 * re1_att + re2 * re2_att + re3 * re3_att
            z1 = torch.mm(e1, self.W)
            z2 = torch.mm(e2, self.W)
            z3 = torch.mm(e3, self.W)
            e1_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z3), dim=1), self.a))))
            e1_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z3), dim=1), self.a))))
            e1_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z3), dim=1), self.a))))
            e2_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z3), dim=1), self.a))))
            e2_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z3), dim=1), self.a))))
            e2_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z3), dim=1), self.a))))
            e3_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z3), dim=1), self.a))))
            e3_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z3), dim=1), self.a))))
            e3_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z3), dim=1), self.a))))

            # e1 = torch.mm(torch.cat((e1, (e2*e1_e2_att + e3*e1_e3_att)), dim=1), self.W0)
            # e2 = torch.mm(torch.cat((e2, (e1*e2_e1_att + e3*e2_e3_att)), dim=1), self.W0)
            # e3 = torch.mm(torch.cat((e3, (e1*e3_e1_att + e2*e3_e2_att)), dim=1), self.W0)
            new_e1 = torch.tanh(z1*e1_e1_att + z2*e1_e2_att + z3*e1_e3_att)
            new_e2 = torch.tanh(z1*e2_e1_att + z2*e2_e2_att + z3*e2_e3_att)
            new_e3 = torch.tanh(z1*e3_e1_att + z2*e3_e2_att + z3*e3_e3_att)
            e = r * new_e1 * new_e2 * new_e3

        elif batch.shape[1] == 5:
            e1 = self.E(batch[:, 1])
            e2 = self.shift(self.E(batch[:, 2]), int(1*self.emb_dim/5))
            e3 = self.shift(self.E(batch[:, 3]), int(2*self.emb_dim/5))
            e4 = self.shift(self.E(batch[:, 4]), int(3*self.emb_dim/5))

            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re4 = self.er_pos_emb(r, e4)


            # re1_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)))
            # re2_att = torch.exp(self.leakyrelu(re2)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)))
            # re3_att = torch.exp(self.leakyrelu(re3)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)))
            # re4_att = torch.exp(self.leakyrelu(re4)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)))
            # r = re1 * re1_att + re2 * re2_att + re3 * re3_att + re4 * re4_att

            e1_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re4), dim=1), self.a))))
            e1_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re4), dim=1), self.a))))
            e1_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re4), dim=1), self.a))))
            e1_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re4), dim=1), self.a))))
            e2_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re4), dim=1), self.a))))
            e2_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re4), dim=1), self.a))))
            e2_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re4), dim=1), self.a))))
            e2_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re4), dim=1), self.a))))
            e3_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re4), dim=1), self.a))))
            e3_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re4), dim=1), self.a))))
            e3_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re4), dim=1), self.a))))
            e3_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re4), dim=1), self.a))))
            e4_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re4), dim=1), self.a))))
            e4_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re4), dim=1), self.a))))
            e4_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re4), dim=1), self.a))))
            e4_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re4), dim=1), self.a))))

            # new_e1 = torch.mm(torch.cat((e1, (z2*e1_e2_att + z3*e1_e3_att + z4*e1_e4_att)), dim=1), self.W0)
            # new_e2 = torch.mm(torch.cat((e2, (z1*e2_e1_att + z3*e2_e3_att + z4*e2_e4_att)), dim=1), self.W0)
            # new_e3 = torch.mm(torch.cat((e3, (z1*e3_e1_att + z2*e3_e2_att + z4*e3_e4_att)), dim=1), self.W0)
            # new_e4 = torch.mm(torch.cat((e4, (z1*e4_e1_att + z2*e4_e2_att + z3*e4_e3_att)), dim=1), self.W0)
            new_e1 = (re1 * e1_e1_att + re2 * e1_e2_att + re3 * e1_e3_att + re4 * e1_e4_att)
            new_e2 = (re1 * e2_e1_att + re2 * e2_e2_att + re3 * e2_e3_att + re4 * e2_e4_att)
            new_e3 = (re1 * e3_e1_att + re2 * e3_e2_att + re3 * e3_e3_att + re4 * e3_e4_att)
            new_e4 = (re1 * e4_e1_att + re2 * e4_e2_att + re3 * e4_e3_att + re4 * e4_e4_att)
            e = r * new_e1 * new_e2 * new_e3 * new_e4


        elif batch.shape[1] == 6:
            e1 = self.E(batch[:, 1])
            e2 = self.shift(self.E(batch[:, 2]), int(1*self.emb_dim/5))
            e3 = self.shift(self.E(batch[:, 3]), int(2*self.emb_dim/5))
            e4 = self.shift(self.E(batch[:, 4]), int(3*self.emb_dim/5))
            e5 = self.shift(self.E(batch[:, 5]), int(4*self.emb_dim/5))

            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re4 = self.er_pos_emb(r, e4)
            re5 = self.er_pos_emb(r, e5)


            # re1_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re2_att = torch.exp(self.leakyrelu(re2)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re3_att = torch.exp(self.leakyrelu(re3)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re4_att = torch.exp(self.leakyrelu(re4)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re5_att = torch.exp(self.leakyrelu(re5)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))

            e1_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re5), dim=1), self.a))))
            e1_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re5), dim=1), self.a))))
            e1_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re5), dim=1), self.a))))
            e1_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re5), dim=1), self.a))))
            e1_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re1, re5), dim=1), self.a))))
            e2_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re5), dim=1), self.a))))
            e2_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re5), dim=1), self.a))))
            e2_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re5), dim=1), self.a))))
            e2_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re5), dim=1), self.a))))
            e2_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re2, re5), dim=1), self.a))))
            e3_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re5), dim=1), self.a))))
            e3_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re5), dim=1), self.a))))
            e3_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re5), dim=1), self.a))))
            e3_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re5), dim=1), self.a))))
            e3_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re3, re5), dim=1), self.a))))
            e4_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re5), dim=1), self.a))))
            e4_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re5), dim=1), self.a))))
            e4_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re5), dim=1), self.a))))
            e4_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re5), dim=1), self.a))))
            e4_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re4, re5), dim=1), self.a))))
            e5_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re5), dim=1), self.a))))
            e5_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re5), dim=1), self.a))))
            e5_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re5), dim=1), self.a))))
            e5_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re5), dim=1), self.a))))
            e5_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((re5, re5), dim=1), self.a))))

            # new_e1 = torch.mm(torch.cat((e1, (z2*e1_e2_att + z3*e1_e3_att + z4*e1_e4_att + z5*e1_e5_att)), dim=1), self.W0)
            # new_e2 = torch.mm(torch.cat((e2, (z1*e2_e1_att + z3*e2_e3_att + z4*e2_e4_att + z5*e2_e5_att)), dim=1), self.W0)
            # new_e3 = torch.mm(torch.cat((e3, (z1*e3_e1_att + z2*e3_e2_att + z4*e3_e4_att + z5*e3_e5_att)), dim=1), self.W0)
            # new_e4 = torch.mm(torch.cat((e4, (z1*e4_e1_att + z2*e4_e2_att + z3*e4_e3_att + z5*e4_e5_att)), dim=1), self.W0)
            # new_e5 = torch.mm(torch.cat((e5, (z1*e5_e1_att + z2*e5_e2_att + z3*e5_e3_att + z4*e5_e4_att)), dim=1), self.W0)
            new_e1 = (re1*e1_e1_att + re2*e1_e2_att + re3*e1_e3_att + re4*e1_e4_att + re5*e1_e5_att)
            new_e2 = (re1*e2_e1_att + re2*e2_e2_att + re3*e2_e3_att + re4*e2_e4_att + re5*e2_e5_att)
            new_e3 = (re1*e3_e1_att + re2*e3_e2_att + re3*e3_e3_att + re4*e3_e4_att + re5*e3_e5_att)
            new_e4 = (re1*e4_e1_att + re2*e4_e2_att + re3*e4_e3_att + re4*e4_e4_att + re5*e4_e5_att)
            new_e5 = (re1*e5_e1_att + re2*e5_e2_att + re3*e5_e3_att + re4*e5_e4_att + re5*e5_e5_att)

            e = r * new_e1 * new_e2 * new_e3 * new_e4 * new_e5

        elif batch.shape[1] == 7:
            e1 = self.E(batch[:, 1])
            e2 = self.E(batch[:, 2])
            e3 = self.E(batch[:, 3])
            e4 = self.E(batch[:, 4])
            e5 = self.E(batch[:, 5])
            e6 = self.E(batch[:, 6])


            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re4 = self.er_pos_emb(r, e4)
            re5 = self.er_pos_emb(r, e5)
            re6 = self.er_pos_emb(r, e6)
            re1_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)))
            re2_att = torch.exp(self.leakyrelu(re2)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)))
            re3_att = torch.exp(self.leakyrelu(re3)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)))
            re4_att = torch.exp(self.leakyrelu(re4)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)))
            re5_att = torch.exp(self.leakyrelu(re5)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)))
            re6_att = torch.exp(self.leakyrelu(re6)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)))
            r = re1 * re1_att + re2 * re2_att + re3 * re3_att + re4 * re4_att + re5 * re5_att + re6 * re6_att
            z1 = torch.mm(e1, self.W)
            z2 = torch.mm(e2, self.W)
            z3 = torch.mm(e3, self.W)
            z4 = torch.mm(e4, self.W)
            z5 = torch.mm(e5, self.W)
            z6 = torch.mm(e6, self.W)
            e1_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z6), dim=1), self.a))))
            e1_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z6), dim=1), self.a))))
            e1_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z6), dim=1), self.a))))
            e1_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z6), dim=1), self.a))))
            e1_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z6), dim=1), self.a))))
            e1_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z1, z6), dim=1), self.a))))
            e2_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z6), dim=1), self.a))))
            e2_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z6), dim=1), self.a))))
            e2_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z6), dim=1), self.a))))
            e2_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z6), dim=1), self.a))))
            e2_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z6), dim=1), self.a))))
            e2_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z2, z6), dim=1), self.a))))
            e3_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z6), dim=1), self.a))))
            e3_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z6), dim=1), self.a))))
            e3_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z6), dim=1), self.a))))
            e3_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z6), dim=1), self.a))))
            e3_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z6), dim=1), self.a))))
            e3_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z3, z6), dim=1), self.a))))
            e4_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z6), dim=1), self.a))))
            e4_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z6), dim=1), self.a))))
            e4_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z6), dim=1), self.a))))
            e4_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z6), dim=1), self.a))))
            e4_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z6), dim=1), self.a))))
            e4_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z4, z6), dim=1), self.a))))
            e5_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z6), dim=1), self.a))))
            e5_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z6), dim=1), self.a))))
            e5_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z6), dim=1), self.a))))
            e5_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z6), dim=1), self.a))))
            e5_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z6), dim=1), self.a))))
            e5_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z5, z6), dim=1), self.a))))
            e6_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z6), dim=1), self.a))))
            e6_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z6), dim=1), self.a))))
            e6_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z6), dim=1), self.a))))
            e6_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z6), dim=1), self.a))))
            e6_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z6), dim=1), self.a))))
            e6_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((z6, z6), dim=1), self.a))))

            # e1 = torch.mm(torch.cat((e1, torch.tanh(e2*e1_e2_att + e3*e1_e3_att + e4*e1_e4_att + e5*e1_e5_att + e6*e1_e6_att)), dim=1), self.W0)
            # e2 = torch.mm(torch.cat((e2, torch.tanh(e1*e2_e1_att + e3*e2_e3_att + e4*e2_e4_att + e5*e2_e5_att + e6*e2_e6_att)), dim=1), self.W0)
            # e3 = torch.mm(torch.cat((e3, torch.tanh(e1*e3_e1_att + e2*e3_e2_att + e4*e3_e4_att + e5*e3_e5_att + e6*e3_e6_att)), dim=1), self.W0)
            # e4 = torch.mm(torch.cat((e4, torch.tanh(e1*e4_e1_att + e2*e4_e2_att + e3*e4_e3_att + e5*e4_e5_att + e6*e4_e6_att)), dim=1), self.W0)
            # e5 = torch.mm(torch.cat((e5, torch.tanh(e1*e5_e1_att + e2*e5_e2_att + e3*e5_e3_att + e4*e5_e4_att + e6*e5_e6_att)), dim=1), self.W0)
            # e6 = torch.mm(torch.cat((e6, torch.tanh(e1*e6_e1_att + e2*e6_e2_att + e3*e6_e3_att + e4*e6_e4_att + e5*e6_e5_att)), dim=1), self.W0)

            new_e1 = torch.tanh(z1*e1_e1_att + z2*e1_e2_att + z3*e1_e3_att + z4*e1_e4_att + z5*e1_e5_att + z6*e1_e6_att)
            new_e2 = torch.tanh(z1*e2_e1_att + z2*e2_e2_att + z3*e2_e3_att + z4*e2_e4_att + z5*e2_e5_att + z6*e2_e6_att)
            new_e3 = torch.tanh(z1*e3_e1_att + z2*e3_e2_att + z3*e3_e3_att + z4*e3_e4_att + z5*e3_e5_att + z6*e3_e6_att)
            new_e4 = torch.tanh(z1*e4_e1_att + z2*e4_e2_att + z3*e4_e3_att + z4*e4_e4_att + z5*e4_e5_att + z6*e4_e6_att)
            new_e5 = torch.tanh(z1*e5_e1_att + z2*e5_e2_att + z3*e5_e3_att + z4*e5_e4_att + z5*e5_e5_att + z6*e5_e6_att)
            new_e6 = torch.tanh(z1*e6_e1_att + z2*e6_e2_att + z3*e6_e3_att + z4*e6_e4_att + z5*e6_e5_att + z6*e6_e6_att)

            e = r * new_e1 * new_e2 * new_e3 * new_e4 * new_e5 * new_e6


        elif batch.shape[1] == 8:
            e1 = self.E(batch[:, 1])
            e2 = self.E(batch[:, 2])
            e3 = self.E(batch[:, 3])
            e4 = self.E(batch[:, 4])
            e5 = self.E(batch[:, 5])
            e6 = self.E(batch[:, 6])
            e7 = self.E(batch[:, 7])
            # re1 = torch.matmul(self.er_pos_emb(r, e1), self.W)
            # re2 = torch.matmul(self.er_pos_emb(r, e2), self.W)
            # re3 = torch.matmul(self.er_pos_emb(r, e3), self.W)
            # re4 = torch.matmul(self.er_pos_emb(r, e4), self.W)
            # re5 = torch.matmul(self.er_pos_emb(r, e5), self.W)
            # re6 = torch.matmul(self.er_pos_emb(r, e6), self.W)
            # re7 = torch.matmul(self.er_pos_emb(r, e7), self.W)
            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re4 = self.er_pos_emb(r, e4)
            re5 = self.er_pos_emb(r, e5)
            re6 = self.er_pos_emb(r, e6)
            re7 = self.er_pos_emb(r, e7)
            re1_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)))
            re2_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)))
            re3_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)))
            re4_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)))
            re5_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)))
            re6_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)))
            re7_att = torch.exp(self.leakyrelu(re7)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)))
            r = re1 * re1_att + re2 * re2_att + re3 * re3_att + re4 * re4_att + re5 * re5_att + re6 * re6_att + re7 * re7_att
            e1_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))))
            e1_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))))
            e1_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))))
            e1_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))))
            e1_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))))
            e1_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))))
            e2_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))))
            e2_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))))
            e2_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))))
            e2_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))))
            e2_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))))
            e2_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))))
            e3_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))))
            e3_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))))
            e3_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))))
            e3_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))))
            e3_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))))
            e3_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))))
            e4_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))))
            e4_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))))
            e4_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))))
            e4_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))))
            e4_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))))
            e4_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))))
            e5_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))))
            e5_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))))
            e5_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))))
            e5_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))))
            e5_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))))
            e5_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))))
            e6_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))))
            e6_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))))
            e6_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))))
            e6_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))))
            e6_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))))
            e6_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))))
            e7_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))))
            e7_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))))
            e7_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))))
            e7_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))))
            e7_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))))
            e7_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))))

            e1 = torch.mm(torch.cat((e1, torch.tanh(e2*e1_e2_att + e3*e1_e3_att + e4*e1_e4_att + e5*e1_e5_att + e6*e1_e6_att + e7*e1_e7_att)), dim=1), self.W0)
            e2 = torch.mm(torch.cat((e2, torch.tanh(e1*e2_e1_att + e3*e2_e3_att + e4*e2_e4_att + e5*e2_e5_att + e6*e2_e6_att + e7*e2_e7_att)), dim=1), self.W0)
            e3 = torch.mm(torch.cat((e3, torch.tanh(e1*e3_e1_att + e2*e3_e2_att + e4*e3_e4_att + e5*e3_e5_att + e6*e3_e6_att + e7*e3_e7_att)), dim=1), self.W0)
            e4 = torch.mm(torch.cat((e4, torch.tanh(e1*e4_e1_att + e2*e4_e2_att + e3*e4_e3_att + e5*e4_e5_att + e6*e4_e6_att + e7*e4_e7_att)), dim=1), self.W0)
            e5 = torch.mm(torch.cat((e5, torch.tanh(e1*e5_e1_att + e2*e5_e2_att + e3*e5_e3_att + e4*e5_e4_att + e6*e5_e6_att + e7*e5_e7_att)), dim=1), self.W0)
            e6 = torch.mm(torch.cat((e6, torch.tanh(e1*e6_e1_att + e2*e6_e2_att + e3*e6_e3_att + e4*e6_e4_att + e5*e6_e5_att + e7*e6_e7_att)), dim=1), self.W0)
            e7 = torch.mm(torch.cat((e7, torch.tanh(e1*e7_e1_att + e2*e7_e2_att + e3*e7_e3_att + e4*e7_e4_att + e5*e7_e5_att + e6*e7_e6_att)), dim=1), self.W0)
            e = r * e1 * e2 * e3 * e4 * e5 * e6 * e7



        elif batch.shape[1] == 9:
            e1 = self.E(batch[:, 1])
            e2 = self.E(batch[:, 2])
            e3 = self.E(batch[:, 3])
            e4 = self.E(batch[:, 4])
            e5 = self.E(batch[:, 5])
            e6 = self.E(batch[:, 6])
            e7 = self.E(batch[:, 7])
            e8 = self.E(batch[:, 8])
            # re1 = torch.matmul(self.er_pos_emb(r, e1), self.W)
            # re2 = torch.matmul(self.er_pos_emb(r, e2), self.W)
            # re3 = torch.matmul(self.er_pos_emb(r, e3), self.W)
            # re4 = torch.matmul(self.er_pos_emb(r, e4), self.W)
            # re5 = torch.matmul(self.er_pos_emb(r, e5), self.W)
            # re6 = torch.matmul(self.er_pos_emb(r, e6), self.W)
            # re7 = torch.matmul(self.er_pos_emb(r, e7), self.W)
            # re8 = torch.matmul(self.er_pos_emb(r, e8), self.W)
            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re4 = self.er_pos_emb(r, e4)
            re5 = self.er_pos_emb(r, e5)
            re6 = self.er_pos_emb(r, e6)
            re7 = self.er_pos_emb(r, e7)
            re8 = self.er_pos_emb(r, e8)
            re1_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)))
            re2_att = torch.exp(self.leakyrelu(re2)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)))
            re3_att = torch.exp(self.leakyrelu(re3)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)))
            re4_att = torch.exp(self.leakyrelu(re4)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)))
            re5_att = torch.exp(self.leakyrelu(re5)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)))
            re6_att = torch.exp(self.leakyrelu(re6)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)))
            re7_att = torch.exp(self.leakyrelu(re7)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)))
            re8_att = torch.exp(self.leakyrelu(re8)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)))
            r = re1 * re1_att + re2 * re2_att + re3 * re3_att + re4 * re4_att + re5 * re5_att + re6 * re6_att + re7 * re7_att + re8 * re8_att
            e1_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))))
            e1_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))))
            e1_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))))
            e1_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))))
            e1_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))))
            e1_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))))
            e1_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))))
            e2_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))))
            e2_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))))
            e2_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))))
            e2_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))))
            e2_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))))
            e2_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))))
            e2_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))))
            e3_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))))
            e3_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))))
            e3_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))))
            e3_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))))
            e3_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))))
            e3_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))))
            e3_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))))
            e4_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))))
            e4_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))))
            e4_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))))
            e4_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))))
            e4_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))))
            e4_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))))
            e4_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))))
            e5_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))))
            e5_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))))
            e5_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))))
            e5_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))))
            e5_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))))
            e5_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))))
            e5_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))))
            e6_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))))
            e6_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))))
            e6_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))))
            e6_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))))
            e6_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))))
            e6_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))))
            e6_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))))
            e7_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))))
            e7_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))))
            e7_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))))
            e7_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))))
            e7_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))))
            e7_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))))
            e7_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))))
            e8_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))))
            e8_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))))
            e8_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))))
            e8_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))))
            e8_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))))
            e8_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))))
            e8_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))))

            e1 = torch.mm(torch.cat((e1, torch.tanh(e2*e1_e2_att + e3*e1_e3_att + e4*e1_e4_att + e5*e1_e5_att + e6*e1_e6_att + e7*e1_e7_att + e8*e1_e8_att)), dim=1), self.W0)
            e2 = torch.mm(torch.cat((e2, torch.tanh(e1*e2_e1_att + e3*e2_e3_att + e4*e2_e4_att + e5*e2_e5_att + e6*e2_e6_att + e7*e2_e7_att + e8*e2_e8_att)), dim=1), self.W0)
            e3 = torch.mm(torch.cat((e3, torch.tanh(e1*e3_e1_att + e2*e3_e2_att + e4*e3_e4_att + e5*e3_e5_att + e6*e3_e6_att + e7*e3_e7_att + e8*e3_e8_att)), dim=1), self.W0)
            e4 = torch.mm(torch.cat((e4, torch.tanh(e1*e4_e1_att + e2*e4_e2_att + e3*e4_e3_att + e5*e4_e5_att + e6*e4_e6_att + e7*e4_e7_att + e8*e4_e8_att)), dim=1), self.W0)
            e5 = torch.mm(torch.cat((e5, torch.tanh(e1*e5_e1_att + e2*e5_e2_att + e3*e5_e3_att + e4*e5_e4_att + e6*e5_e6_att + e7*e5_e7_att + e8*e5_e8_att)), dim=1), self.W0)
            e6 = torch.mm(torch.cat((e6, torch.tanh(e1*e6_e1_att + e2*e6_e2_att + e3*e6_e3_att + e4*e6_e4_att + e5*e6_e5_att + e7*e6_e7_att + e8*e6_e8_att)), dim=1), self.W0)
            e7 = torch.mm(torch.cat((e7, torch.tanh(e1*e7_e1_att + e2*e7_e2_att + e3*e7_e3_att + e4*e7_e4_att + e5*e7_e5_att + e6*e7_e6_att + e8*e7_e8_att)), dim=1), self.W0)
            e8 = torch.mm(torch.cat((e8, torch.tanh(e1*e8_e1_att + e2*e8_e2_att + e3*e8_e3_att + e4*e8_e4_att + e5*e8_e5_att + e6*e8_e6_att + e7*e8_e7_att)), dim=1), self.W0)

            e = r * e1 * e2 * e3 * e4 * e5 * e6 * e7 * e8


        elif batch.shape[1] == 10:
            e1 = self.E(batch[:, 1])
            e2 = self.E(batch[:, 2])
            e3 = self.E(batch[:, 3])
            e4 = self.E(batch[:, 4])
            e5 = self.E(batch[:, 5])
            e6 = self.E(batch[:, 6])
            e7 = self.E(batch[:, 7])
            e8 = self.E(batch[:, 8])
            e9 = self.E(batch[:, 9])
            # re1 = torch.matmul(self.er_pos_emb(r, e1), self.W)
            # re2 = torch.matmul(self.er_pos_emb(r, e2), self.W)
            # re3 = torch.matmul(self.er_pos_emb(r, e3), self.W)
            # re4 = torch.matmul(self.er_pos_emb(r, e4), self.W)
            # re5 = torch.matmul(self.er_pos_emb(r, e5), self.W)
            # re6 = torch.matmul(self.er_pos_emb(r, e6), self.W)
            # re7 = torch.matmul(self.er_pos_emb(r, e7), self.W)
            # re8 = torch.matmul(self.er_pos_emb(r, e8), self.W)
            # re9 = torch.matmul(self.er_pos_emb(r, e9), self.W)
            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re4 = self.er_pos_emb(r, e4)
            re5 = self.er_pos_emb(r, e5)
            re6 = self.er_pos_emb(r, e6)
            re7 = self.er_pos_emb(r, e7)
            re8 = self.er_pos_emb(r, e8)
            re9 = self.er_pos_emb(r, e9)
            re1_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)) + torch.exp(self.leakyrelu(re9)))
            re2_att = torch.exp(self.leakyrelu(re2)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)) + torch.exp(self.leakyrelu(re9)))
            re3_att = torch.exp(self.leakyrelu(re3)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)) + torch.exp(self.leakyrelu(re9)))
            re4_att = torch.exp(self.leakyrelu(re4)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)) + torch.exp(self.leakyrelu(re9)))
            re5_att = torch.exp(self.leakyrelu(re5)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)) + torch.exp(self.leakyrelu(re9)))
            re6_att = torch.exp(self.leakyrelu(re6)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)) + torch.exp(self.leakyrelu(re9)))
            re7_att = torch.exp(self.leakyrelu(re7)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)) + torch.exp(self.leakyrelu(re9)))
            re8_att = torch.exp(self.leakyrelu(re8)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)) + torch.exp(self.leakyrelu(re9)))
            re9_att = torch.exp(self.leakyrelu(re9)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)) + torch.exp(self.leakyrelu(re9)))
            r = re1 * re1_att + re2 * re2_att + re3 * re3_att + re4 * re4_att + re5 * re5_att + re6 * re6_att + re7 * re7_att + re8 * re8_att + re9 * re9_att
            e1_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e9), dim=1), self.a))))
            e1_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e9), dim=1), self.a))))
            e1_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e9), dim=1), self.a))))
            e1_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e9), dim=1), self.a))))
            e1_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e9), dim=1), self.a))))
            e1_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e9), dim=1), self.a))))
            e1_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e9), dim=1), self.a))))
            e1_e9_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e9), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e9), dim=1), self.a))))
            e2_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e9), dim=1), self.a))))
            e2_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e9), dim=1), self.a))))
            e2_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e9), dim=1), self.a))))
            e2_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e9), dim=1), self.a))))
            e2_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e9), dim=1), self.a))))
            e2_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e9), dim=1), self.a))))
            e2_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e9), dim=1), self.a))))
            e2_e9_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e9), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e9), dim=1), self.a))))
            e3_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e9), dim=1), self.a))))
            e3_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e9), dim=1), self.a))))
            e3_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e9), dim=1), self.a))))
            e3_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e9), dim=1), self.a))))
            e3_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e9), dim=1), self.a))))
            e3_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e9), dim=1), self.a))))
            e3_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e9), dim=1), self.a))))
            e3_e9_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e9), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e9), dim=1), self.a))))
            e4_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e9), dim=1), self.a))))
            e4_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e9), dim=1), self.a))))
            e4_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e9), dim=1), self.a))))
            e4_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e9), dim=1), self.a))))
            e4_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e9), dim=1), self.a))))
            e4_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e9), dim=1), self.a))))
            e4_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e9), dim=1), self.a))))
            e4_e9_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e9), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e9), dim=1), self.a))))
            e5_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e9), dim=1), self.a))))
            e5_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e9), dim=1), self.a))))
            e5_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e9), dim=1), self.a))))
            e5_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e9), dim=1), self.a))))
            e5_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e9), dim=1), self.a))))
            e5_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e9), dim=1), self.a))))
            e5_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e9), dim=1), self.a))))
            e5_e9_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e9), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e9), dim=1), self.a))))
            e6_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e9), dim=1), self.a))))
            e6_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e9), dim=1), self.a))))
            e6_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e9), dim=1), self.a))))
            e6_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e9), dim=1), self.a))))
            e6_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e9), dim=1), self.a))))
            e6_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e9), dim=1), self.a))))
            e6_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e9), dim=1), self.a))))
            e6_e9_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e9), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e9), dim=1), self.a))))
            e7_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e9), dim=1), self.a))))
            e7_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e9), dim=1), self.a))))
            e7_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e9), dim=1), self.a))))
            e7_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e9), dim=1), self.a))))
            e7_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e9), dim=1), self.a))))
            e7_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e9), dim=1), self.a))))
            e7_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e9), dim=1), self.a))))
            e7_e9_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e9), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e9), dim=1), self.a))))
            e8_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e9), dim=1), self.a))))
            e8_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e9), dim=1), self.a))))
            e8_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e9), dim=1), self.a))))
            e8_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e9), dim=1), self.a))))
            e8_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e9), dim=1), self.a))))
            e8_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e9), dim=1), self.a))))
            e8_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e9), dim=1), self.a))))
            e8_e9_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e9), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e9), dim=1), self.a))))
            e9_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e8), dim=1), self.a))))
            e9_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e8), dim=1), self.a))))
            e9_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e8), dim=1), self.a))))
            e9_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e8), dim=1), self.a))))
            e9_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e8), dim=1), self.a))))
            e9_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e8), dim=1), self.a))))
            e9_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e8), dim=1), self.a))))
            e9_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e8), dim=1), self.a))))

            e1 = torch.mm(torch.cat((e1, torch.tanh(e2*e1_e2_att + e3*e1_e3_att + e4*e1_e4_att + e5*e1_e5_att + e6*e1_e6_att + e7*e1_e7_att + e8*e1_e8_att + e9*e1_e9_att)), dim=1), self.W0)
            e2 = torch.mm(torch.cat((e2, torch.tanh(e1*e2_e1_att + e3*e2_e3_att + e4*e2_e4_att + e5*e2_e5_att + e6*e2_e6_att + e7*e2_e7_att + e8*e2_e8_att + e9*e2_e9_att)), dim=1), self.W0)
            e3 = torch.mm(torch.cat((e3, torch.tanh(e1*e3_e1_att + e2*e3_e2_att + e4*e3_e4_att + e5*e3_e5_att + e6*e3_e6_att + e7*e3_e7_att + e8*e3_e8_att + e9*e3_e9_att)), dim=1), self.W0)
            e4 = torch.mm(torch.cat((e4, torch.tanh(e1*e4_e1_att + e2*e4_e2_att + e3*e4_e3_att + e5*e4_e5_att + e6*e4_e6_att + e7*e4_e7_att + e8*e4_e8_att + e9*e4_e9_att)), dim=1), self.W0)
            e5 = torch.mm(torch.cat((e5, torch.tanh(e1*e5_e1_att + e2*e5_e2_att + e3*e5_e3_att + e4*e5_e4_att + e6*e5_e6_att + e7*e5_e7_att + e8*e5_e8_att + e9*e5_e9_att)), dim=1), self.W0)
            e6 = torch.mm(torch.cat((e6, torch.tanh(e1*e6_e1_att + e2*e6_e2_att + e3*e6_e3_att + e4*e6_e4_att + e5*e6_e5_att + e7*e6_e7_att + e8*e6_e8_att + e9*e6_e9_att)), dim=1), self.W0)
            e7 = torch.mm(torch.cat((e7, torch.tanh(e1*e7_e1_att + e2*e7_e2_att + e3*e7_e3_att + e4*e7_e4_att + e5*e7_e5_att + e6*e7_e6_att + e8*e7_e8_att + e9*e7_e9_att)), dim=1), self.W0)
            e8 = torch.mm(torch.cat((e8, torch.tanh(e1*e8_e1_att + e2*e8_e2_att + e3*e8_e3_att + e4*e8_e4_att + e5*e8_e5_att + e6*e8_e6_att + e7*e8_e7_att + e9*e8_e9_att)), dim=1), self.W0)
            e9 = torch.mm(torch.cat((e9, torch.tanh(e1*e9_e1_att + e2*e9_e2_att + e3*e9_e3_att + e4*e9_e4_att + e5*e9_e5_att + e6*e9_e6_att + e7*e9_e7_att + e8*e9_e8_att)), dim=1), self.W0)

            e = r * e1 * e2 * e3 * e4 * e5 * e6 * e7 * e8 * e9


        x = e
        x = self.hidden_drop(x)
        return torch.sum(x, dim=1)
